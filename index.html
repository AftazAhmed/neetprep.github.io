<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Class 9 - PbP</title>
<style>
  body {
    font-family: 'Montserrat', Arial, sans-serif;
    margin: 0;
    padding: 16px 8px;
    background-color: #f9fafb;
    color: #1f2937;
    overflow-x: hidden;
    font-size: 14.04px;
  }
  
  .header {
    text-align: center;
    background-color: #023047;
    color: #ffb347;
    padding: 32px 16px 24px 16px;
    border-radius: 10px;
    margin-bottom: 24px;
    position: relative;
    overflow: hidden;
  }
  
  .header::before {
    content: '';
    position: absolute;
    top: -50%;
    left: -50%;
    width: 200%;
    height: 200%;
    background: radial-gradient(circle at center, #4f59b0 0%, transparent 70%);
    opacity: 0.3;
    pointer-events: none;
  }
  
  .header h1 {
    position: relative;
    margin: 0 0 8px 0;
    font-size: 2.7rem;
    font-weight: 900;
    letter-spacing: 2px;
    color: #ffa726;
  }
  
  .header .subtitle {
    position: relative;
    font-size: 17.28px;
    font-weight: 600;
    color: #b9fbc0;
    letter-spacing: 0.6px;
  }
  
  .ai-btn {
    width: 32px;
    height: 32px;
    border-radius: 50%;
    background: linear-gradient(135deg, #dc2626 0%, #2563eb 100%);
    color: white;
    border: none;
    font-size: 12.96px;
    font-weight: 700;
    cursor: pointer;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    transition: all 0.3s;
    box-shadow: 0 2px 8px rgba(220, 38, 38, 0.3);
  }
  
  .ai-btn:hover {
    transform: scale(1.1);
    box-shadow: 0 4px 12px rgba(220, 38, 38, 0.5);
  }
  
  .chatgpt-btn {
    background: linear-gradient(90deg, #dc2626 0%, #2563eb 100%);
    color: white;
    border: none;
    padding: 6px 14px;
    border-radius: 20px;
    font-size: 11.88px;
    font-weight: 700;
    cursor: pointer;
    transition: all 0.3s;
    box-shadow: 0 2px 6px rgba(0,0,0,0.2);
  }
  
  .chatgpt-btn:hover {
    transform: scale(1.05);
    box-shadow: 0 4px 10px rgba(0,0,0,0.3);
  }
  
  .frac {
    display: inline-block;
    vertical-align: middle;
    text-align: center;
    margin: 0 3px;
  }
  
  .frac .num {
    display: block;
    padding: 1px 4px;
    border-bottom: 2px solid currentColor;
    line-height: 1.2;
    font-size: 0.95em;
  }
  
  .frac .den {
    display: block;
    padding: 1px 4px;
    line-height: 1.2;
    font-size: 0.95em;
  }
  
  .frac-lg {
    display: inline-block;
    vertical-align: middle;
    text-align: center;
    font-size: 1em;
    margin: 0 4px;
  }
  
  .frac-lg .num {
    display: block;
    padding: 3px 8px;
    border-bottom: 3px solid currentColor;
    font-weight: 700;
    line-height: 1.3;
  }
  
  .frac-lg .den {
    display: block;
    padding: 3px 8px;
    font-weight: 700;
    line-height: 1.3;
  }
  
  .note-image, .note-image-bordered {
    margin: 16px auto;
    text-align: center;
    max-width: 100%;
  }
  
  .note-image img, .note-image-bordered img {
    max-width: 100%;
    height: auto;
    border-radius: 8px;
    display: block;
    margin: 0 auto;
  }
  
  .note-image-bordered img {
    border: 2px solid #028090;
    padding: 8px;
    background: white;
  }
  
  .image-caption {
    font-size: 12.96px;
    color: #116466;
    font-weight: 600;
    margin-top: 8px;
    font-style: italic;
    text-align: center;
  }
  
  .notes-container {
    max-width: 100%;
    margin: 0 auto;
    background: white;
    padding: 20px 4px;
    border-radius: 8px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
  }
  
  .notes-title {
    font-size: 23.76px;
    font-weight: 800;
    color: #023047;
    margin-bottom: 20px;
    text-align: center;
    border-bottom: 3px solid #028090;
    padding-bottom: 10px;
  }
  
  .note-segment {
    margin-bottom: 24px;
    padding: 16px 8px;
    background: #f9fafb;
    border-radius: 6px;
    border-left: 4px solid #028090;
    position: relative;
  }
  
  .note-segment .ai-btn {
    position: absolute;
    top: 12px;
    right: 8px;
  }
  
  .segment-heading {
    font-size: 18.36px;
    font-weight: 700;
    color: #116466;
    margin-bottom: 12px;
    padding-right: 40px;
  }
  
  .segment-subheading {
    font-size: 16.2px;
    font-weight: 700;
    color: #2a6f62;
    margin-top: 12px;
    margin-bottom: 8px;
  }
  
  .note-paragraph {
    font-size: 14.04px;
    line-height: 1.6;
    color: #1f2937;
    margin-bottom: 10px;
    text-align: justify;
  }
  
  .note-table {
    width: 100%;
    border-collapse: collapse;
    margin: 16px 0;
    background: white;
    border-radius: 6px;
    overflow: hidden;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    font-size: 12.96px;
  }
  
  .note-table th {
    background: linear-gradient(135deg, #667eea, #764ba2);
    color: white;
    padding: 10px 8px;
    text-align: left;
    font-weight: 700;
    font-size: 12.96px;
  }
  
  .note-table td {
    padding: 10px 8px;
    border-bottom: 1px solid #e5e7eb;
    font-size: 12.96px;
    line-height: 1.5;
  }
  
  .note-table tr:last-child td {
    border-bottom: none;
  }
  
  .note-table tr:hover {
    background-color: #f9fafb;
  }
  
  .equation-box {
    background: linear-gradient(135deg, #e3f2fd, #bbdefb);
    border: 2px solid #2196f3;
    padding: 14px;
    margin: 14px 0;
    border-radius: 6px;
    text-align: center;
  }
  
  .equation-text {
    font-size: 16.2px;
    font-weight: 600;
    color: #0d47a1;
  }
  
  .definition-box {
    background: linear-gradient(135deg, #e3f2fd, #bbdefb);
    border-left: 4px solid #2196f3;
    padding: 12px 16px;
    margin: 12px 0;
    border-radius: 6px;
  }
  
  .definition-term {
    font-weight: 700;
    color: #0d47a1;
    font-size: 15.12px;
    margin-bottom: 6px;
  }
  
  .definition-text {
    color: #1565c0;
    line-height: 1.6;
    font-size: 14.04px;
  }
  
  .important-note {
    background: linear-gradient(135deg, #ffebee, #ffcdd2);
    border: 2px solid #f44336;
    padding: 12px 16px;
    margin: 12px 0;
    border-radius: 6px;
    font-size: 14.04px;
  }
  
  .important-note strong {
    color: #c62828;
  }
  
  .mcq-container {
    max-width: 700px;
    margin: 0 auto;
  }
  
  .score-display {
    background: linear-gradient(135deg, #0369a1 0%, #0284c7 50%, #0ea5e9 100%);
    color: white;
    padding: 12px 16px;
    border-radius: 8px;
    margin-bottom: 16px;
    text-align: center;
    font-weight: 700;
    font-size: 17.28px;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }
  
  .reset-score-btn {
    background: #ff9800;
    color: #000000;
    border: none;
    padding: 6px 12px;
    border-radius: 6px;
    font-size: 12.96px;
    font-weight: 700;
    cursor: pointer;
    transition: all 0.3s;
  }
  
  .reset-score-btn:hover {
    background: #fb8c00;
  }
  
  .question-count {
    font-weight: 700;
    font-size: 16.2px;
    color: #116466;
    margin-bottom: 14px;
    border-left: 4px solid #028090;
    padding-left: 12px;
  }
  
  .question-item {
    background-color: #fff8f0;
    border-radius: 8px;
    border: 1.5px solid #f0c49c;
    margin-bottom: 20px;
    padding: 16px;
    font-size: 14.04px;
  }
  
  .question-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 12px;
    gap: 8px;
  }
  
  .question-number {
    font-weight: 700;
    font-size: 17.28px;
    color: #2a6f62;
  }
  
  .question-text {
    font-weight: 600;
    font-size: 14.04px;
    color: #255c4d;
    margin-bottom: 12px;
    line-height: 1.6;
  }
  
  .options {
    margin-bottom: 14px;
  }
  
  .option {
    background-color: #ffffff;
    border-radius: 6px;
    border: 1.8px solid #b5d0c8;
    padding: 10px 14px;
    margin: 6px 0;
    font-weight: 500;
    font-size: 14.04px;
    color: #244636;
    cursor: pointer;
    transition: all 0.3s;
    position: relative;
  }
  
  .option:hover:not(.selected) {
    background-color: #e8f5f1;
    border-color: #71b280;
  }
  
  .option.selected.correct {
    background-color: #d4edda;
    border-color: #28a745;
  }
  
  .option.selected.wrong {
    background-color: #f8d7da;
    border-color: #dc3545;
  }
  
  .option.selected.correct::after {
    content: "‚úì";
    position: absolute;
    right: 12px;
    top: 50%;
    transform: translateY(-50%);
    color: #28a745;
    font-weight: 700;
    font-size: 19.44px;
  }
  
  .option.selected.wrong::after {
    content: "‚úó";
    position: absolute;
    right: 12px;
    top: 50%;
    transform: translateY(-50%);
    color: #dc3545;
    font-weight: 700;
    font-size: 19.44px;
  }
  
  .answer-display {
    background: linear-gradient(135deg, #d4edda, #c3e6cb);
    border: 2px solid #28a745;
    border-radius: 6px;
    padding: 12px;
    margin: 12px 0;
    font-size: 14.04px;
    font-weight: 600;
    color: #155724;
    display: none;
  }
  
  .answer-display.show {
    display: block;
  }
  
  .hint-display {
    background: linear-gradient(135deg, #fff3e0, #ffe0b2);
    border: 2px solid #ff9800;
    border-radius: 6px;
    padding: 12px;
    margin: 12px 0;
    font-size: 14.04px;
    font-weight: 600;
    color: #e65100;
    display: none;
  }
  
  .hint-display.show {
    display: block;
  }
  
  .button-group {
    display: flex;
    gap: 10px;
    flex-wrap: wrap;
  }
  
  .btn {
    padding: 8px 14px;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    font-weight: 700;
    font-size: 14.04px;
    transition: all 0.3s;
  }
  
  .btn-answer {
    background-color: #047857;
    color: #ffffff;
  }
  
  .btn-answer:hover {
    background-color: #065f46;
  }
  
  .btn-hint {
    background-color: #dc2626;
    color: #ffffff;
  }
  
  .btn-hint:hover {
    background-color: #b91c1c;
  }
  
  .mark-badge {
    display: inline-block;
    padding: 5px 12px;
    border-radius: 16px;
    font-size: 11.88px;
    font-weight: 700;
    margin-left: 8px;
    vertical-align: middle;
  }
  
  .mark-1 { background: linear-gradient(135deg, #4caf50, #66bb6a); color: white; }
  .mark-2 { background: linear-gradient(135deg, #2196f3, #42a5f5); color: white; }
  .mark-3 { background: linear-gradient(135deg, #ff9800, #ffa726); color: white; }
  .mark-5 { background: linear-gradient(135deg, #f44336, #ef5350); color: white; }
  
  .qa-container {
    max-width: 100%;
    margin: 0 auto;
    padding: 0;
  }
  
  .qa-item {
    background: white;
    border-radius: 8px;
    padding: 14px 6px;
    margin-bottom: 16px;
    box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    border-left: 4px solid #028090;
    position: relative;
  }
  
  .qa-item .ai-btn {
    position: absolute;
    top: 12px;
    right: 6px;
  }
  
  .qa-item.mark-1-item { border-left-color: #4caf50; }
  .qa-item.mark-2-item { border-left-color: #2196f3; }
  .qa-item.mark-3-item { border-left-color: #ff9800; }
  .qa-item.mark-5-item { border-left-color: #f44336; }
  
  .qa-question {
    font-size: 15.12px;
    font-weight: 700;
    color: #023047;
    margin-bottom: 14px;
    line-height: 1.6;
    padding-right: 40px;
  }
  
  .qa-question-number {
    display: inline-block;
    background: linear-gradient(135deg, #667eea, #764ba2);
    color: white;
    padding: 5px 12px;
    border-radius: 16px;
    font-size: 12.96px;
    margin-right: 8px;
    font-weight: 700;
  }
  
  .qa-answer-section {
    background: #f9fafb;
    padding: 12px 6px;
    border-radius: 6px;
    margin-top: 12px;
  }
  
  .qa-answer-label {
    font-weight: 700;
    color: #116466;
    font-size: 15.12px;
    margin-bottom: 10px;
    display: block;
  }
  
  .answer-1mark, .answer-2mark, .answer-3mark, .answer-5mark {
    padding: 10px 6px;
    border-radius: 6px;
    font-size: 14.04px;
    line-height: 1.6;
  }
  
  .answer-1mark {
    background: linear-gradient(135deg, #e8f5e9, #c8e6c9);
    border-left: 3px solid #4caf50;
  }
  
  .answer-2mark {
    background: linear-gradient(135deg, #e3f2fd, #bbdefb);
    border-left: 3px solid #2196f3;
  }
  
  .answer-2mark .point {
    margin: 8px 0;
    padding-left: 18px;
    position: relative;
    font-size: 14.04px;
    line-height: 1.6;
  }
  
  .answer-2mark .point:before {
    content: "‚óè";
    position: absolute;
    left: 0;
    color: #2196f3;
    font-weight: 700;
  }
  
  .answer-3mark {
    background: linear-gradient(135deg, #fff3e0, #ffe0b2);
    border-left: 3px solid #ff9800;
  }
  
  .answer-3mark .point {
    margin: 10px 0;
    padding: 8px 6px;
    background: white;
    border-radius: 5px;
    font-size: 14.04px;
    line-height: 1.6;
  }
  
  .answer-3mark .point strong {
    color: #e65100;
  }
  
  .answer-5mark {
    background: linear-gradient(135deg, #ffebee, #ffcdd2);
    border-left: 3px solid #f44336;
  }
  
  .answer-5mark .section {
    margin: 10px 0;
    padding: 10px 8px;
    background: white;
    border-radius: 6px;
  }
  
  .answer-5mark .section h5 {
    margin: 0 0 8px 0;
    color: #c62828;
    font-size: 15.12px;
  }
  
  .answer-5mark .section p {
    margin: 6px 0;
    font-size: 14.04px;
    line-height: 1.6;
  }
  
  sub { font-size: 0.75em; vertical-align: sub; }
  sup { font-size: 0.75em; vertical-align: super; }
  
  .controls {
    display: flex;
    flex-wrap: wrap;
    gap: 12px;
    margin-bottom: 12px;
    justify-content: center;
    align-items: center;
  }
  
  .dropdown-group {
    min-width: 140px;
    flex: 1;
  }
  
  label {
    display: block;
    font-weight: 700;
    font-size: 14.04px;
    margin-bottom: 5px;
    color: #344e41;
  }
  
  select {
    width: 100%;
    padding: 8px 10px;
    border-radius: 6px;
    border: 2px solid #028090;
    font-size: 14.04px;
    background-color: #ffffff;
    color: #023047;
    transition: 0.3s;
  }
  
  select:focus {
    outline: none;
    border-color: #023047;
    background-color: #e0f7f4;
  }
  
  .reload-btn {
    cursor: pointer;
    background-color: #8b5cf6;
    border: none;
    color: #fff;
    padding: 8px 12px;
    border-radius: 6px;
    font-weight: 700;
    font-size: 12.96px;
    height: 34px;
    transition: all 0.3s;
  }
  
  .reload-btn:hover {
    background-color: #7c3aed;
  }
  
  .view-toggle {
    display: flex;
    gap: 10px;
    margin-bottom: 16px;
    justify-content: center;
    flex-wrap: wrap;
  }
  
  .view-btn {
    padding: 8px 16px;
    border: 2px solid #028090;
    background: white;
    color: #023047;
    border-radius: 6px;
    font-weight: 700;
    font-size: 14.04px;
    cursor: pointer;
    transition: all 0.3s;
  }
  
  .view-btn:hover, .view-btn.active {
    background: #028090;
    color: white;
  }
  
  .mark-filter {
    display: flex;
    gap: 6px;
    justify-content: center;
    margin-bottom: 16px;
    flex-wrap: wrap;
  }
  
  .mark-filter-btn {
    padding: 6px 12px;
    border: 2px solid #e0e0e0;
    background: white;
    border-radius: 16px;
    cursor: pointer;
    font-weight: 600;
    font-size: 11.88px;
    transition: all 0.3s;
  }
  
  .mark-filter-btn:hover { border-color: #028090; }
  .mark-filter-btn.active { border-color: transparent; }
  
  .mark-filter-btn.filter-1.active { background: linear-gradient(135deg, #4caf50, #66bb6a); color: white; }
  .mark-filter-btn.filter-2.active { background: linear-gradient(135deg, #2196f3, #42a5f5); color: white; }
  .mark-filter-btn.filter-3.active { background: linear-gradient(135deg, #ff9800, #ffa726); color: white; }
  .mark-filter-btn.filter-5.active { background: linear-gradient(135deg, #f44336, #ef5350); color: white; }
  .mark-filter-btn.filter-all.active { background: linear-gradient(135deg, #667eea, #764ba2); color: white; }
  
  @media (max-width: 900px) {
    .header h1 { font-size: 2.16rem; }
    .header .subtitle { font-size: 15.12px; }
    .notes-container { padding: 16px 4px; }
    .qa-container { padding: 0; }
    .qa-item { padding: 14px 4px; }
    .qa-answer-section { padding: 10px 4px; }
    .answer-1mark, .answer-2mark, .answer-3mark, .answer-5mark { padding: 10px 4px; }
  }
</style>
</head>
<body>

<div class="header" role="banner">
  <h1>Class 9</h1>
  <div class="subtitle">Pagewise Notes, MCQs, Q&A</div>
</div>

<div class="controls">
  <div class="dropdown-group">
    <label for="chapterSelect">Chapter:</label>
    <select id="chapterSelect" onchange="updatePages()">
      <option value="">Select Chapter</option>
      <option value="1">Chapter 1: Atoms and molecules</option>
      <option value="2">Chapter 2: Gravitation</option>
      <option value="3">Chapter 3</option>
      <option value="4">Chapter 4</option>
      <option value="5">Chapter 5</option>
      <option value="6">Chapter 6</option>
      <option value="7">Chapter 7</option>
      <option value="8">Chapter 8</option>
      <option value="9">Chapter 9</option>
      <option value="10">Chapter 10</option>
    </select>
  </div>
  <div class="dropdown-group">
    <label for="pageSelect">Page:</label>
    <select id="pageSelect" onchange="loadPage()" disabled>
      <option value="">Select Page</option>
    </select>
  </div>
  <button class="reload-btn" onclick="window.location.reload()">‚Üª Reload</button>
</div>

<div class="view-toggle">
  <button class="view-btn active" onclick="switchView('mcq')">MCQs</button>
  <button class="view-btn" onclick="switchView('notes')">Notes</button>
  <button class="view-btn" onclick="switchView('qa')">Q&A</button>
</div>

<div id="mcqMode" class="mode-container">
  <div class="mcq-container">
    <div id="mcqContent">
      <p style="text-align:center; padding:40px; color:#666; font-size:15.12px;">Select a chapter and page to view MCQs</p>
    </div>
  </div>
</div>

<div id="notesMode" class="mode-container" style="display:none;">
  <div class="notes-container">
    <div id="notesContent">
      <p style="text-align:center; padding:40px; color:#666; font-size:15.12px;">Select a chapter and page to view notes</p>
    </div>
  </div>
</div>

<div id="qaMode" class="mode-container" style="display:none;">
  <h2 style="text-align:center; color:#023047; margin-bottom:20px; font-size:21.6px;">üìù Questions & Answers</h2>
  
  <div class="mark-filter">
    <button class="mark-filter-btn filter-all active" onclick="filterByMark('all')">All Questions</button>
    <button class="mark-filter-btn filter-1" onclick="filterByMark(1)">1 Mark</button>
    <button class="mark-filter-btn filter-2" onclick="filterByMark(2)">2 Marks</button>
    <button class="mark-filter-btn filter-3" onclick="filterByMark(3)">3 Marks</button>
    <button class="mark-filter-btn filter-5" onclick="filterByMark(5)">5 Marks</button>
  </div>
  
  <div class="qa-container">
    <div id="qaContent">
      <p style="text-align:center; padding:40px; color:#666; font-size:15.12px;">Select a chapter and page to view Q&A</p>
    </div>
  </div>
</div>

<script>
  function frac(numerator, denominator, large = false) {
    const cls = large ? 'frac-lg' : 'frac';
    return `<span class="${cls}"><span class="num">${numerator}</span><span class="den">${denominator}</span></span>`;
  }

  let pageScores = JSON.parse(localStorage.getItem('pageScores')) || {};

  const chapterData = {
    "1": {
      "1": { mcqData: [], notesData: [], qaData: [] },
      "2": { mcqData: [], notesData: [], qaData: [] },
      "3": { mcqData: [], notesData: [], qaData: [] },
      "4": { mcqData: [], notesData: [], qaData: [] },
      "5": { mcqData: [], notesData: [], qaData: [] },
      "6": { mcqData: [], notesData: [], qaData: [] },
      "7": { mcqData: [], notesData: [], qaData: [] },
      "8": { mcqData: [], notesData: [], qaData: [] },
      "9": { mcqData: [], notesData: [], qaData: [] },
      "10": { mcqData: [], notesData: [], qaData: [] }
    },
    "2": {
      "1": { mcqData: [], notesData: [], qaData: [] },
      "2": { mcqData: [], notesData: [], qaData: [] },
      "3": { mcqData: [], notesData: [], qaData: [] },
      "4": { mcqData: [], notesData: [], qaData: [] },
      "5": { mcqData: [], notesData: [], qaData: [] },
      "6": { mcqData: [], notesData: [], qaData: [] },
      "7": { mcqData: [], notesData: [], qaData: [] },
      "8": { mcqData: [], notesData: [], qaData: [] },
      "9": { mcqData: [], notesData: [], qaData: [] },
      "10": { mcqData: [], notesData: [], qaData: [] }
    },
    "3": {
      "1": { mcqData: [], notesData: [], qaData: [] },
      "2": { mcqData: [], notesData: [], qaData: [] },
      "3": { mcqData: [], notesData: [], qaData: [] },
      "4": { mcqData: [], notesData: [], qaData: [] },
      "5": { mcqData: [], notesData: [], qaData: [] },
      "6": { mcqData: [], notesData: [], qaData: [] },
      "7": { mcqData: [], notesData: [], qaData: [] },
      "8": { mcqData: [], notesData: [], qaData: [] },
      "9": { mcqData: [], notesData: [], qaData: [] },
      "10": { mcqData: [], notesData: [], qaData: [] }
    },
    "4": {
      "1": { mcqData: [], notesData: [], qaData: [] },
      "2": { mcqData: [], notesData: [], qaData: [] },
      "3": { mcqData: [], notesData: [], qaData: [] },
      "4": { mcqData: [], notesData: [], qaData: [] },
      "5": { mcqData: [], notesData: [], qaData: [] },
      "6": { mcqData: [], notesData: [], qaData: [] },
      "7": { mcqData: [], notesData: [], qaData: [] },
      "8": { mcqData: [], notesData: [], qaData: [] },
      "9": { mcqData: [], notesData: [], qaData: [] },
      "10": { mcqData: [], notesData: [], qaData: [] }
    },
    "5": {
      "1": { mcqData: [], notesData: [], qaData: [] },
      "2": { mcqData: [], notesData: [], qaData: [] },
      "3": { mcqData: [], notesData: [], qaData: [] },
      "4": { mcqData: [], notesData: [], qaData: [] },
      "5": { mcqData: [], notesData: [], qaData: [] },
      "6": { mcqData: [], notesData: [], qaData: [] },
      "7": { mcqData: [], notesData: [], qaData: [] },
      "8": { mcqData: [], notesData: [], qaData: [] },
      "9": { mcqData: [], notesData: [], qaData: [] },
      "10": { mcqData: [], notesData: [], qaData: [] }
    },
    "6": {
      "1": { mcqData: [], notesData: [], qaData: [] },
      "2": { mcqData: [], notesData: [], qaData: [] },
      "3": { mcqData: [], notesData: [], qaData: [] },
      "4": { mcqData: [], notesData: [], qaData: [] },
      "5": { mcqData: [], notesData: [], qaData: [] },
      "6": { mcqData: [], notesData: [], qaData: [] },
      "7": { mcqData: [], notesData: [], qaData: [] },
      "8": { mcqData: [], notesData: [], qaData: [] },
      "9": { mcqData: [], notesData: [], qaData: [] },
      "10": { mcqData: [], notesData: [], qaData: [] }
    },
    "7": {
      "1": { mcqData: [], notesData: [], qaData: [] },
      "2": { mcqData: [], notesData: [], qaData: [] },
      "3": { mcqData: [], notesData: [], qaData: [] },
      "4": { mcqData: [], notesData: [], qaData: [] },
      "5": { mcqData: [], notesData: [], qaData: [] },
      "6": { mcqData: [], notesData: [], qaData: [] },
      "7": { mcqData: [], notesData: [], qaData: [] },
      "8": { mcqData: [], notesData: [], qaData: [] },
      "9": { mcqData: [], notesData: [], qaData: [] },
      "10": { mcqData: [], notesData: [], qaData: [] }
    },
    "8": {
      "1": { mcqData: [], notesData: [], qaData: [] },
      "2": { mcqData: [], notesData: [], qaData: [] },
      "3": { mcqData: [], notesData: [], qaData: [] },
      "4": { mcqData: [], notesData: [], qaData: [] },
      "5": { mcqData: [], notesData: [], qaData: [] },
      "6": { mcqData: [], notesData: [], qaData: [] },
      "7": { mcqData: [], notesData: [], qaData: [] },
      "8": { mcqData: [], notesData: [], qaData: [] },
      "9": { mcqData: [], notesData: [], qaData: [] },
      "10": { mcqData: [], notesData: [], qaData: [] }
    },
    "9": {
      "1": { mcqData: [], notesData: [], qaData: [] },
      "2": { mcqData: [], notesData: [], qaData: [] },
      "3": { mcqData: [], notesData: [], qaData: [] },
      "4": { mcqData: [], notesData: [], qaData: [] },
      "5": { mcqData: [], notesData: [], qaData: [] },
      "6": { mcqData: [], notesData: [], qaData: [] },
      "7": { mcqData: [], notesData: [], qaData: [] },
      "8": { mcqData: [], notesData: [], qaData: [] },
      "9": { mcqData: [], notesData: [], qaData: [] },
      "10": { mcqData: [], notesData: [], qaData: [] }
    },
    "10": {
      "1": { mcqData: [], notesData: [], qaData: [] },
      "2": { mcqData: [], notesData: [], qaData: [] },
      "3": { mcqData: [], notesData: [], qaData: [] },
      "4": { mcqData: [], notesData: [], qaData: [] },
      "5": { mcqData: [], notesData: [], qaData: [] },
      "6": { mcqData: [], notesData: [], qaData: [] },
      "7": { mcqData: [], notesData: [], qaData: [] },
      "8": { mcqData: [], notesData: [], qaData: [] },
      "9": { mcqData: [], notesData: [], qaData: [] },
      "10": { mcqData: [], notesData: [], qaData: [] }
    }
  };

  function updatePages() {
    const chapter = document.getElementById('chapterSelect').value;
    const pageSelect = document.getElementById('pageSelect');
    pageSelect.innerHTML = '<option value="">Select Page</option>';
    pageSelect.disabled = true;
    
    if (chapterData[chapter]) {
      Object.keys(chapterData[chapter]).forEach(pageNum => {
        pageSelect.innerHTML += `<option value="${pageNum}">Page ${pageNum}</option>`;
      });
      pageSelect.disabled = false;
    }
  }

  function loadPage() {
    const chapter = document.getElementById('chapterSelect').value;
    const page = document.getElementById('pageSelect').value;
    displayMCQs(chapter, page);
    displayNotes(chapter, page);
    displayQA(chapter, page);
  }

  function switchView(mode) {
    document.getElementById('mcqMode').style.display = 'none';
    document.getElementById('notesMode').style.display = 'none';
    document.getElementById('qaMode').style.display = 'none';
    document.getElementById(mode + 'Mode').style.display = 'block';
    
    document.querySelectorAll('.view-btn').forEach(btn => btn.classList.remove('active'));
    event.target.classList.add('active');
  }

  function getPageKey() {
    const chapter = document.getElementById('chapterSelect').value;
    const page = document.getElementById('pageSelect').value;
    return `ch${chapter}_p${page}`;
  }

  function updateScore(correct) {
    const pageKey = getPageKey();
    if (!pageScores[pageKey]) {
      pageScores[pageKey] = { correct: 0, total: 0 };
    }
    if (correct) {
      pageScores[pageKey].correct++;
    }
    pageScores[pageKey].total++;
    localStorage.setItem('pageScores', JSON.stringify(pageScores));
    displayScoreBoard();
  }

  function displayScoreBoard() {
    const pageKey = getPageKey();
    const score = pageScores[pageKey] || { correct: 0, total: 0 };
    const scoreHTML = `
      <div class="score-display">
        <span>Score: ${score.correct} / ${score.total}</span>
        <button class="reset-score-btn" onclick="resetScore()">Reset</button>
      </div>
    `;
    return scoreHTML;
  }

  function resetScore() {
    const pageKey = getPageKey();
    if (pageScores[pageKey]) {
      pageScores[pageKey] = { correct: 0, total: 0 };
      localStorage.setItem('pageScores', JSON.stringify(pageScores));
      const chapter = document.getElementById('chapterSelect').value;
      const page = document.getElementById('pageSelect').value;
      displayMCQs(chapter, page);
    }
  }

  function displayMCQs(chapter, page) {
    const container = document.getElementById('mcqContent');
    const data = chapterData[chapter]?.[page]?.mcqData || [];
    
    if (!data.length) {
      container.innerHTML = '<p style="text-align:center; padding:40px; color:#666; font-size:15.12px;">No MCQs available for this page.</p>';
      return;
    }
    
    container.innerHTML = displayScoreBoard();
    
    data.forEach((mcq, idx) => {
      const optionsHTML = mcq.options.map(opt => 
        `<div class="option" onclick="handleMCQClick(event, '${mcq.correct}', ${idx})">${opt}</div>`
      ).join('');
      
      container.innerHTML += `
        <div class="question-item">
          <div class="question-header">
            <span class="question-number">Q${idx + 1}</span>
            <button class="ai-btn" onclick="openChatGPT('${escapeForJS(mcq.question)}')">AI</button>
          </div>
          <div class="question-text">${mcq.question}</div>
          <div class="options" data-question="${idx}">
            ${optionsHTML}
          </div>
          <div class="answer-display" id="answer${idx}"><strong>Correct Answer:</strong> ${mcq.correct}</div>
          <div class="hint-display" id="hint${idx}"><strong>Hint:</strong> ${mcq.hint || 'No hint available'}</div>
          <div class="button-group">
            <button class="btn btn-answer" onclick="toggleAnswer(${idx})">Show Answer</button>
            <button class="btn btn-hint" onclick="toggleHint(${idx})">Show Hint</button>
            <button class="chatgpt-btn" onclick="openChatGPT('${escapeForJS(mcq.question)}')">Ask ChatGPT</button>
          </div>
        </div>
      `;
    });
  }

  function escapeForJS(text) {
    return text.replace(/'/g, "\\'").replace(/"/g, '\\"').replace(/\n/g, ' ');
  }

  function handleMCQClick(event, correct, qIdx) {
    const clickedOption = event.target;
    const optionsContainer = clickedOption.parentElement;
    const allOptions = optionsContainer.querySelectorAll('.option');
    
    // Check if already answered
    const hasAnswer = Array.from(allOptions).some(opt => opt.classList.contains('selected'));
    if (hasAnswer) return;
    
    // Check if clicked option is correct
    const selectedText = clickedOption.textContent.trim();
    const correctText = correct.trim();
    
    if (selectedText === correctText) {
      clickedOption.classList.add('selected', 'correct');
      updateScore(true);
    } else {
      clickedOption.classList.add('selected', 'wrong');
      updateScore(false);
      // Also highlight the correct answer
      allOptions.forEach(opt => {
        if (opt.textContent.trim() === correctText) {
          opt.classList.add('selected', 'correct');
        }
      });
    }
  }

  function toggleAnswer(idx) {
    const answer = document.getElementById('answer' + idx);
    if (answer.classList.contains('show')) {
      answer.classList.remove('show');
      event.target.textContent = 'Show Answer';
    } else {
      answer.classList.add('show');
      event.target.textContent = 'Hide Answer';
    }
  }

  function toggleHint(idx) {
    const hint = document.getElementById('hint' + idx);
    if (hint.classList.contains('show')) {
      hint.classList.remove('show');
      event.target.textContent = 'Show Hint';
    } else {
      hint.classList.add('show');
      event.target.textContent = 'Hide Hint';
    }
  }

  function openChatGPT(question) {
    const url = `https://chat.openai.com/?q=${encodeURIComponent(question)}`;
    window.open(url, '_blank');
  }

  function displayNotes(chapter, page) {
    const container = document.getElementById('notesContent');
    const data = chapterData[chapter]?.[page]?.notesData || [];
    
    if (!data.length) {
      container.innerHTML = '<p style="text-align:center; padding:40px; color:#666; font-size:15.12px;">No notes available for this page.</p>';
      return;
    }
    
    container.innerHTML = '';
    data.forEach(note => {
      container.innerHTML += `
        <div class="note-segment">
          <button class="ai-btn" onclick="openChatGPT('${escapeForJS(note.heading)}')">AI</button>
          <div class="segment-heading">${note.heading}</div>
          ${note.content}
        </div>
      `;
    });
  }

  let currentMarkFilter = 'all';

  function displayQA(chapter, page) {
    const container = document.getElementById('qaContent');
    const data = chapterData[chapter]?.[page]?.qaData || [];
    
    if (!data.length) {
      container.innerHTML = '<p style="text-align:center; padding:40px; color:#666; font-size:15.12px;">No Q&A available for this page.</p>';
      return;
    }
    
    const filtered = currentMarkFilter === 'all' 
      ? data 
      : data.filter(q => q.marks === parseInt(currentMarkFilter));
    
    if (!filtered.length) {
      container.innerHTML = '<p style="text-align:center; padding:40px; color:#666; font-size:15.12px;">No questions match the selected filter.</p>';
      return;
    }
    
    container.innerHTML = '';
    filtered.forEach((qa, idx) => {
      container.innerHTML += `
        <div class="qa-item mark-${qa.marks}-item">
          <button class="ai-btn" onclick="openChatGPT('${escapeForJS(qa.question)}')">AI</button>
          <div class="qa-question">
            <span class="qa-question-number">${qa.marks}M</span>
            ${qa.question}
          </div>
          <div class="qa-answer-section">
            <span class="qa-answer-label">Answer:</span>
            <div class="answer-${qa.marks}mark">${qa.answer}</div>
          </div>
        </div>
      `;
    });
  }

  function filterByMark(mark) {
    currentMarkFilter = mark;
    const chapter = document.getElementById('chapterSelect').value;
    const page = document.getElementById('pageSelect').value;
    
    if (chapter && page) {
      displayQA(chapter, page);
    }
    
    document.querySelectorAll('.mark-filter-btn').forEach(btn => btn.classList.remove('active'));
    event.target.classList.add('active');
  }
</script>

</body>
</html>

